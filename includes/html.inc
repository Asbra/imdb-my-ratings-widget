<?php
/**
 * @author  Johan / Asbra <johan@asbra.net>
 *
 * @version 1.0
 * @date    2014-07-20
 */
$format = 'html';

header('Content-Type: text/html; charset=UTF-8');

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Cache
$cache_path = "cache/{$imdb_id}-{$width}x{$height}.{$format}";

if (!$debug) {
    if (file_exists($cache_path)) {
        if ((time() - filemtime($cache_path)) <= 60 * 10) { // if data is more than 10 minutes old
            die(file_get_contents($cache_path));
        }
    }
}

ob_start();

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Get data
require 'imdb.inc';

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Load template
if (file_exists('templates/main.min.inc')) {
    require 'templates/main.min.inc';
} else {
    require 'templates/main.inc';
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Save output and display it
$output = ob_get_clean();
echo $output;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Save to cache
if (!$debug) {
    file_put_contents($cache_path, $output);
}
